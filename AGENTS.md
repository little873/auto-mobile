# AGENTS.md

此 AGENTS.md 为在此项目上工作的 AI 代理（例如，Copilot、Aider、Codex、Claude Code 等）提供背景和说明。它通过提供特定于项目的设置、指南和技术细节来补充 README.md，从而在不干扰面向人类文档的情况下，实现高效的代码生成、调试和贡献。

## 项目概述
auto-mobile 是手机端智能助理框架，灵感源于 Open-AutoGLM。它能够以多模态方式理解手机屏幕内容，并通过自动化操作帮助用户完成任务。系统通过 ADB(Android Debug Bridge)来控制设备，以视觉语言模型进行屏幕感知，再结合智能规划能力生成并执行操作流程。用户只需用自然语言描述需求，auto-mobile 即可自动解析意图、理解当前界面、规划下一步动作并完成整个流程。系统还内置敏感操作确认机制，并支持在登录或验证码场景下进行人工接管。同时，它提供远程 ADB 调试能力，可通过 WiFi 或网络连接设备，实现灵活的远程控制与开发。

## 目录结构
- `src/`: 基于 Kotlin 的核心逻辑.
    - `src/main/resources`: 存放配置文件（如 model-config.json）和提示词模板（如 prompts-zh）。
    - `src/main/kotlin`: 核心源代码，包含设备控制、模型交互和配置管理。
- `MEMO.md`: 编码代理的详细信息，包括规范、技术架构、项目进展和其他有用笔记。
- `TODO.md`: 高度复杂任务的规范，由人类编写。
- `AGENTS.md`: 本文档用于编码代理。

## 代码风格指南
- **通用**:
    - 命名和风格：遵循编程语言的最佳实践和最惯用的用法。
    - 一致的缩进：4 个空格（不要制表符）。
    - 不要尾随空格，不要不必要的空行。
    - 注释：公共 API 使用文档注释；复杂逻辑使用行内注释。
- **Kotlin**:
  - 遵循官方 Kotlin 编码规范 (`kotlin.code.style=official`)。
  - 优先使用不可变性（`val` 优于 `var`）。
  - 使用 `kotlinx.serialization` 进行 JSON 解析。
  - 充分利用 Kotlin 的扩展函数和单例对象（`object`）来简化工具类。
- **错误处理**:
    - 关键路径（如 ADB 执行、网络请求）必须使用 `try-catch` 捕获异常。
    - 对于可预见的失败，优先返回 `null` 或使用 `Result` 包装类，而不是直接抛出未捕获异常。
    - 记录有意义的错误日志，帮助定位 ADB 连接或模型响应问题。

## 开发环境
- **GitHub Repository**: `https://github.com/little873/auto-mobile`
- **工具链**:
    - Kotlin: 1.9.x 或更高版本。
    - adb: Android SDK Platform-Tools (建议版本 34+)。
    - Gradle: 8.14 (通过 Gradle Wrapper 管理)。
- **编译器**: IntelliJ IDEA (建议安装 Kotlin 插件)。


## 边界
- **始终执行**:
    - 保持代码干净和模块化，易于理解和维护。
    - 在用户确认主要任务完成后，在 MEMO.md 中更新项目进展。
- **操作前请确认**:
    - 在大幅度修改现有源代码之前（即修改超过 3 个源文件）。
    - 修改 IDEA 项目设置。
- **永远不要**:
    - 在单个迭代中提交多个主要任务。
    - 使用 cat 来创建或编辑文件。

这份文档是一个动态参考——随着项目的演进而更新。对于贡献，优先处理 TODO 事项。